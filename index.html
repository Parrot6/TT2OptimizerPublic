<html>
    <!--ü¶ç üíé üçå Buy, Hodl üçå üíé ü¶ç-->
    <!--Author: Parrot6
        Discord: Parrot6#7225
        Reddit: u/Killerparrot6
    -->
    <head>
        <title>TT2 SP Optimizer</title>
        <link rel="stylesheet" href="assets/app.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
        <script src="scripties/jquery.js"></script>
        <script src="scripties/underscore.js"> </script>
        <script src="scripties/backbone.js"></script>
        <script src="scripties/treeStructure.js"></script>
        <script src="scripties/calculationsSP.js"></script>
        <script src="scripties/spTreeClassObject.js"></script>
        <script src="scripties/staticDataObjects.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="manifest" href="manifest.json">
    </head>

    <body>
        <div class="sheetNavigation row no-gutters">
            <div id="sp" class="sheetNavigationButton col no-gutters text-center active"><a href="#sp">SP Optimizer</a></div>
            <div id="artifact" class="sheetNavigationButton col no-gutters text-center"><a href="#artifact">Artifact Optimizer</a></div>
            <div id="saveloadnav" class="sheetNavigationButton col no-gutters text-center"><a href="#saveload">Save/Load</a></div>
            <div id="other" class="sheetNavigationButton col-auto no-gutters text-center px-1"><a href="https://parrot6.com">&nbsp&nbspParrot6&nbsp&nbsp</a></div>
            <div class="col no-gutters text-center"><button style="height: calc(100% - 6px); white-space: nowrap;" class="controllerButtonImport pr-1" onclick="userHardReload()">v5.26.03 (Click To Clear Cache+Reload)</button></div>
        </div>
        <div class="row buildTypeSection no-gutters">
            <div class="col-md-3 col-sm-12">
                <div class="row no-gutters">
                    <div class="col-auto alignLabelVert">
                        <label for="buildDmgType">Dmg Type:&nbsp</label>
                    </div>
                    <div class="col">
                        <select name="dmgchoices" id="buildDmgType">
                        </select>
                    </div>
                </div>
                <div class="row no-gutters pt-1">
                    <div class="col-auto alignLabelVert">
                        <label for="buildGoldType">Gold Type:&nbsp</label>
                    </div>
                    <div class="col">
                        <select name="goldchoices" id="buildGoldType">
                        </select>
                    </div>
                </div>
            </div>
            <div class="col spTopChoices">
                <div class="row  no-gutters">
                    <div class="col-auto alignLabelVert">
                        <label>Sp Spent:&nbsp</label>
                    </div>
                    <div class="col-12 col-sm">
                        <input id="spSpent" disabled value="0"/>
                    </div>
                </div>
                <button class="controllerButton" onclick="resetTree()">Reset Tree</button>
            </div>
            <div class="col spTopChoices">
                <div class="row no-gutters">
                    <div class="col-auto alignLabelVert">
                        <label>Starting Sp:&nbsp</label>
                    </div>
                    <div class="col-12 col-sm">
                        <input onchange="updateStartingSp(this)" id="startingSp"/>
                    </div>
                </div>
                <button class="controllerButton" onclick="spendAllSP()">Spend All Available Sp</button>
            </div>
            <div class="col artifactTopChoices">
                <div class="row no-gutters">
                    <div class="col-3 alignLabelVert">
                        <label for="artifactHeroType">Hero Type:&nbsp</label>
                    </div>
                    <div class="col">
                        <select onchange="processArtifacts(artifactCSV)" id="artifactHeroType">
                            <option value="Ranged">Ranged</option>
                            <option value="Melee">Melee</option>
                            <option value="Mage">Mage</option>
                            <option value="All">Equal</option>
                        </select>
                    </div>
                </div>
                <div class="row no-gutters">
                    <div class="col-3 alignLabelVert">
                        <label for="artifactFlyingGroundType">Ground/Flying:&nbsp</label>
                    </div>
                    <div class="col">
                        <select onchange="processArtifacts(artifactCSV)" id="artifactFlyingGroundType">
                            <option value="Flying">Flying</option>
                            <option value="Ground">Ground</option>
                        </select>
                    </div>
                </div>
                <div class="row no-gutters">
                    <div class="col-3 alignLabelVert">
                        <label for="artifactViewChoice">Artifact View:</label>
                    </div>
                    <div class="col">
                        <select onchange="artifactViewToggle()" id="artifactViewChoice">
                            <option value="True">Show Upgrades Only</option>
                            <option value="False">Show Artifacts and Upgrades</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-2 artifactTopChoices text-center">
                <div id="artifactsDiscovered" class="mt-1">Artifacts: 98/98</div>
                <div id="enchantmentsDiscovered" class="mt-2">Enchantments: 34/34</div> 
            </div>
        </div>
        <div class="sheet active" id="spOptimizer">
            <div class="row no-gutters">
                <div class="col-12 col-md-10 no-gutters">
                    <div class="row no-gutters grid2x2">
                        <div id="knightTree" class="col-6 col-sm-6 col-xl-4 no-gutters box box0">
                        </div>
                        <div id="petTree" class="col-6 col-sm-6 col-xl-4 no-gutters box box1">
                        </div>
                    <!-- </div>
                    <div class="row no-gutters grid2x2"> -->
                        <div id="warlordTree" class="col-6 col-sm-6 col-xl-4 no-gutters box box2">
                        </div>
                        <div id="sorcererTree" class="col-6 col-sm-6 col-xl-4 no-gutters box box3">
                        </div>
                    <!-- </div>
                    <div class="row no-gutters grid2x2"> -->
                    <div id="rogueTree" class="col-6 col-sm-6 col-xl-4 no-gutters box box4">
                    </div>
                    <div id="alchemistTree" class="col-6 col-sm-6 col-xl-4 no-gutters box box5 text-center">
                        Soon‚Ñ¢Ô∏è
                    </div>
                    </div>
                </div>
                <div class="col-3 col-md-2 no-gutters">
                        <Strong>Skill Rankings:</Strong>
                        <div id="SkillRankings">

                        </div>
                </div>
                <div class="col-9 col-md-12 no-gutters">

                    <div class="row no-gutters">
                        <div class="col importCol col-gutters">
                            <Button class="controllerButtonImport" onclick="importData(false)">Import Stats from Clipboard</Button>
                            <input id="importPaste" onchange="importData(this.value)" placeholder="OR paste here (firefox)" type="text">
                        <!--- <Button class="controllerButtonImport" onclick="importData(true)">Import Stats from Cookies (TODO)</Button> --->
                            <div class="row no-gutters">
                                <div class="col-auto alignLabelVert">
                                    <label><Strong>Skills&nbsp</Strong></label>
                                </div>
                                <div class="col">
                                    <button id="loadSkills" onclick="loadSkillsFrom(playerSkills)" class="controllerButtonImport">Load Skills</button>
                                </div>
                            </div>
                            <div id="Skills">
                                
                            </div>
                        </div>
                        <div class="col importCol col-gutters">
                            <div class="row no-gutters">
                                <div>
                                    <Strong>Statistics&nbsp</Strong>
                                </div>
                            </div>
                            <div id="Probabilities">
                                
                            </div>
                        </div>
                        <div class="col importCol col-gutters">
                            <div><Strong>Equipment Sets</Strong>
                            <div id="EquipmentSets">
                                
                            </div>
                        </div> 
                        </div>
                        <div class="col importCol col-gutters">
                            <div id="Passives">
                                <Strong>Passives</Strong>
                            </div>
                        </div>
                        <div class="col importCol col-gutters">                    
                            <div id="PlayerStatistics">
                            <Strong>Player Stats</Strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sheet" id="artifactOptimizer">
            <div class="row no-gutters">
                <div class="col-12 no-gutters">
                <div class="row relics px-1 py-1">
                    <div class="col-3 pr-0" style="overflow: hidden;">
                        <div class="row">
                            <div class="col-auto pr-0">Relics Available:</div>
                            <div class="col-md pl-md-1 col-sm-12 pt-2 pt-md-0"><input onchange="availableRelicsUpdated(this)" id="relicsAvailable"></div>
                        </div>
                    </div>
                    <div class="col-3 pl-1 pr-0">
                        <div class="row">
                         <div class="col-auto pr-0">Relics Earned:</div>
                         <div class="col-md pl-md-1 col-sm-12 pt-2 pt-md-0"><input id="relicsSpent" disabled type="number" value="112341231231"></div>   
                        </div>
                    </div>
                    <div class="col-6 pl-1">
                        
                        <div class="row no-gutters">
                           <div class="col-6 pr-0"><button class="controllerButtonImport" onclick="artifactImport(false)">Import Clipboard</button></div>
                        <div class="col-6 pl-1"><input id="artifactPasteImport" type="text" onchange="artifactImport(this.value)"  placeholder="OR Paste Export Here"/></div> 
                        </div>
                        <div class="row py-1 no-gutters">
                            <select onchange="updateUpgradeButton(this.value)" style="text-align: center" class="artifactButton">
                                <option style="text-align: center" value="1">Spend 1%</option>
                                <option selected="selected" value="5">Spend 5%</option>
                                <option value="25">Spend 25%</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            <div class="row no-gutters">
                <div id="artifactHolder" class="col-md col-sm-12">

                </div>
                <div id="aritactSuggestions" class="col-md col-sm-12 px-1">

                </div>
            </div>
        </div>
        <div class="sheet" id="otherProjects" onclick="window.open('https://parrot6.com','mywindow');">
        </div>
        <div class="sheet" id="saveload">
            <h1 class="mx-5 text-center">SAVE</h1>
            <div class="mx-5 text-center">
                <div class="text-center">To update a build, save with the same display name and Email.</div>
                <label class="font-weight-bold my-1" for="saveName">* Display Name:</label>
                <input class="text-center text-primary w-50" id="saveName" name="save_name" type="text" placeholder="HS no qte 3k">
                <label class="font-weight-bold my-1" for="clancode">Clan Code:</label>
                <input class="text-center text-primary w-50" maxlength="5" id="clancode" name="clancode" type="text" placeholder="z48ez (case insensitive)">
                <label class="font-weight-bold my-1" for="email">Email/Passphrase (to Overwrite/Delete later):</label>
                <input class="text-center text-primary w-50" id="email" name="email" type="text" placeholder="">
                <label class="font-weight-bold my-1" for="buildnotes">Notes:</label>
                <input class="text-center text-primary w-50" id="buildnotes" name="buildnotes" type="text" placeholder="ex: Requires X mythic set... ">
                <div class="text-center alert-danger w-50 mx-auto">
                    Warning: If you save a build without an email/passphrase, somebody could overwrite/delete your build.
                    </br>
                </div>
                <div class="text-center w-75 mx-auto">
                    <button class="btn btn-success my-2 mr-2" onclick="populatePreviewSPJson()" type="submit">Preview</button><button class="btn btn-primary my-2 w-50" onclick="saveData()" type="submit">Save</button>
                </div>
            </div>
            <hr class="my-2 border border-primary">
            <h1 class="mx-5 text-center">SEARCH ID </h1>
            <div class="mx-5 text-center">
                <a class="mx-5 text-center w-100" target=‚Äù_blank‚Äù href="../TT2Builds/">>>> Browse Every Build Here <<<</a>
                <label class="font-weight-bold my-1" for="loadBuildId">ID:</label>
                <input class="text-center text-primary w-50" id="loadBuildId" name="build_id" type="text" placeholder="39">
                <button class="btn btn-primary my-1 w-50" onclick="loadData()" type="submit">Search</button>
            </div>
            <div class="text-center p-2 w-50 mx-auto" style="background: whitesmoke; border-radius: 8px; border-style: double; border-width: 3px; border-color: black;" id="loadResultView">
               load results here....
            </div>
            <hr class="my-2 border border-primary">
            <h1 class="mx-5 text-center">SEARCH BY CLAN</h1>
            <div class="mx-5 text-center">
                <label class="font-weight-bold my-1" for="loadClanName" class="fw-bold">* Clan Code:</label>
                <input class="text-center text-primary w-50" id="loadClanName" name="save_name" type="text" placeholder="z48ez">
                <button class="btn btn-primary my-1 w-50" onclick="loadClanData()" type="submit">Search</button>
            </div>
            <div class="text-center p-2 w-50 mx-auto" style="background: whitesmoke; border-radius: 8px; border-style: double; border-width: 3px; border-color: black;" id="loadClanResultView">
                load results here....
            </div>
            <hr class="my-2 border border-primary">
            <h1 class="mx-5 text-center">DELETE BUILD</h1>
            <div class="mx-5 text-center">
                <label class="font-weight-bold my-1" for="deleteSaveName" class="fw-bold">* Save Name:</label>
                <input class="text-center text-primary w-50" id="deleteSaveName" name="deleteSaveName" type="text" placeholder="">
                <label class="font-weight-bold my-1" for="deleteSavePass" class="fw-bold">* Build Email/Pass:</label>
                <input class="text-center text-primary w-50" id="deleteSavePass" name="deleteSavePass" type="text" placeholder="">
                <button class="btn btn-danger my-1 w-50" onclick="deleteBuild()" type="submit">Delete</button>
            </div>
            <div id="previewWindow" name="previewWindow" style="visibility: hidden;">
                <div class="row my-1">
                    <div class="col-1"></div><div id="previewWindowTitle" class="font-weight-bold col text-center">Preview</div><div onclick="closePreview()" class="font-weight-bold col-1 text-right w-25 mr-2">X</div>
                </div>
                <div class="row no-gutters font-weight-bold">
                    <div class="col-12">
                        <div class="row no-gutters">
                            <div class="col-6 previewBranch" id="KnightPreview">
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell"></div>
                                    <div class="col-4 text-center previewCell" id="KnightPreview0">-</div>
                                    <div class="col-4 text-center previewCell"></div>
                                </div>
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell" id="KnightPreview1">-</div>
                                    <div class="col-4 text-center previewCell" id="KnightPreview2">-</div>
                                    <div class="col-4 text-center previewCell" id="KnightPreview3">-</div>
                                </div>
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell" id="KnightPreview4">-</div>
                                    <div class="col-4 text-center previewCell" id="KnightPreview5">-</div>
                                    <div class="col-4 text-center previewCell" id="KnightPreview6">-</div>
                                </div>
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell" id="KnightPreview7">-</div>
                                    <div class="col-4 text-center previewCell" id="KnightPreview8">-</div>
                                    <div class="col-4 text-center previewCell" id="KnightPreview9">-</div>
                                </div>
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell" id="KnightPreview10"></div>
                                    <div class="col-4 text-center previewCell" id="KnightPreview11"></div>
                                    <div class="col-4 text-center previewCell" id="KnightPreview12">-</div>
                                </div>
                            </div>
                            <div class="col-6 previewBranch" id="WarlordPreview">
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell"></div>
                                    <div class="col-4 text-center previewCell" id="WarlordPreview0">-</div>
                                    <div class="col-4 text-center previewCell"></div>
                                </div>
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell" id="WarlordPreview1">-</div>
                                    <div class="col-4 text-center previewCell" id="WarlordPreview2">-</div>
                                    <div class="col-4 text-center previewCell" id="WarlordPreview3">-</div>
                                </div>
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell" id="WarlordPreview4">-</div>
                                    <div class="col-4 text-center previewCell" id="WarlordPreview5">-</div>
                                    <div class="col-4 text-center previewCell" id="WarlordPreview6">-</div>
                                </div>
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell" id="WarlordPreview7">-</div>
                                    <div class="col-4 text-center previewCell" id="WarlordPreview8">-</div>
                                    <div class="col-4 text-center previewCell" id="WarlordPreview9">-</div>
                                </div>
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell" id="WarlordPreview10"></div>
                                    <div class="col-4 text-center previewCell" id="WarlordPreview11"></div>
                                    <div class="col-4 text-center previewCell" id="WarlordPreview12">-</div>
                                </div>
                            </div> 
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="row no-gutters">
                            <div class="col-6 previewBranch" id="SorcererPreview">
                        <div class="row previewRow no-gutters" id="">
                            <div class="col-4 text-center previewCell"></div>
                            <div class="col-4 text-center previewCell" id="SorcererPreview0">-</div>
                            <div class="col-4 text-center previewCell"></div>
                        </div>
                        <div class="row previewRow no-gutters" id="">
                            <div class="col-4 text-center previewCell" id="SorcererPreview1">-</div>
                            <div class="col-4 text-center previewCell" id="SorcererPreview2">-</div>
                            <div class="col-4 text-center previewCell" id="SorcererPreview3">-</div>
                        </div>
                        <div class="row previewRow no-gutters" id="">
                            <div class="col-4 text-center previewCell" id="SorcererPreview4">-</div>
                            <div class="col-4 text-center previewCell" id="SorcererPreview5">-</div>
                            <div class="col-4 text-center previewCell" id="SorcererPreview6">-</div>
                        </div>
                        <div class="row previewRow no-gutters" id="">
                            <div class="col-4 text-center previewCell" id="SorcererPreview7">-</div>
                            <div class="col-4 text-center previewCell" id="SorcererPreview8">-</div>
                            <div class="col-4 text-center previewCell" id="SorcererPreview9">-</div>
                        </div> 
                        <div class="row previewRow no-gutters" id="">
                            <div class="col-4 text-center previewCell" id="SorcererPreview10">-</div>
                            <div class="col-4 text-center previewCell" id="SorcererPreview11"></div>
                            <div class="col-4 text-center previewCell" id="SorcererPreview12"></div>
                        </div>
                        </div>  
                        <div class="col-6 previewBranch" id="RoguePreview">
                            <div class="row previewRow no-gutters" id="">
                                <div class="col-4 text-center previewCell"></div>
                                <div class="col-4 text-center previewCell" id="RoguePreview0">-</div>
                                <div class="col-4 text-center previewCell"></div>
                            </div>
                            <div class="row previewRow no-gutters" id="">
                                <div class="col-4 text-center previewCell" id="RoguePreview1">-</div>
                                <div class="col-4 text-center previewCell" id="RoguePreview2">-</div>
                                <div class="col-4 text-center previewCell" id="RoguePreview3">-</div>
                            </div>
                            <div class="row previewRow no-gutters" id="">
                                <div class="col-4 text-center previewCell" id="RoguePreview4">-</div>
                                <div class="col-4 text-center previewCell" id="RoguePreview5">-</div>
                                <div class="col-4 text-center previewCell" id="RoguePreview6">-</div>
                            </div>
                            <div class="row previewRow no-gutters" id="">
                                <div class="col-4 text-center previewCell" id="RoguePreview7">-</div>
                                <div class="col-4 text-center previewCell" id="RoguePreview8">-</div>
                                <div class="col-4 text-center previewCell" id="RoguePreview9">-</div>
                            </div>
                            <div class="row previewRow no-gutters" id="">
                                <div class="col-4 text-center previewCell" id="RoguePreview10"></div>
                                <div class="col-4 text-center previewCell" id="RoguePreview11">-</div>
                                <div class="col-4 text-center previewCell" id="RoguePreview12"></div>
                            </div>
                        </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="row no-gutters">
                            <div class="col-6 previewBranch" id="PetPreview">
                            <div class="row previewRow no-gutters" id="">
                                <div class="col-4 text-center previewCell"></div>
                                <div class="col-4 text-center previewCell" id="PetPreview0">-</div>
                                <div class="col-4 text-center previewCell"></div>
                            </div>
                            <div class="row previewRow no-gutters" id="">
                                <div class="col-4 text-center previewCell" id="PetPreview1">-</div>
                                <div class="col-4 text-center previewCell" id="PetPreview2">-</div>
                                <div class="col-4 text-center previewCell" id="PetPreview3">-</div>
                            </div>
                            <div class="row previewRow no-gutters" id="">
                                <div class="col-4 text-center previewCell" id="PetPreview4">-</div>
                                <div class="col-4 text-center previewCell" id="PetPreview5">-</div>
                                <div class="col-4 text-center previewCell" id="PetPreview6">-</div>
                            </div>
                            <div class="row previewRow no-gutters" id="">
                                <div class="col-4 text-center previewCell" id="PetPreview7">-</div>
                                <div class="col-4 text-center previewCell" id="PetPreview8">-</div>
                                <div class="col-4 text-center previewCell" id="PetPreview9">-</div>
                            </div>
                            <div class="row previewRow no-gutters" id="">
                                <div class="col-4 text-center previewCell" id="PetPreview10"></div>
                                <div class="col-4 text-center previewCell" id="PetPreview11"></div>
                                <div class="col-4 text-center previewCell" id="PetPreview12">-</div>
                            </div>
                            </div>
                            <div class="col-6 previewBranch" id="AlchemistPreview">
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell"></div>
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview0">-</div>
                                    <div class="col-4 text-center previewCell"></div>
                                </div>
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview1">-</div>
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview2">-</div>
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview3">-</div>
                                </div>
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview4">-</div>
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview5">-</div>
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview6">-</div>
                                </div>
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview7">-</div>
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview8">-</div>
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview9">-</div>
                                </div>
                                <div class="row previewRow no-gutters" id="">
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview10"></div>
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview11"></div>
                                    <div class="col-4 text-center previewCell" id="AlchemistPreview12"></div>
                                </div> 
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
    <style>
       
    </style>
    <script>
        function closePreview(){
            document.getElementById('previewWindow').style.visibility = "Hidden";
        }
        function populatePreviewSPJson(){
            document.getElementById('previewWindow').style.visibility = "Visible";
            Object.keys(SPJsonArray).forEach(function(key){
                var thisele = document.getElementById(saveTalentIDClass[SPJsonArray[key].TalentID] + "Preview" + saveTalentIDSlots[SPJsonArray[key].TalentID])
                if(thisele !== undefined) thisele.innerText = SPJsonArray[key].Level;
            })
        }
        function populatePreview(index = null){
            document.getElementById('previewWindow').style.visibility = "Visible";
            let data;
            if(index !== null){
                try{
                    data = JSON.parse(previewdata[index].json_blob);
                } catch {
                    data = previewdata[index].json_blob
                }
            } else {
                try{
                    data = JSON.parse(previewdata);
                } catch {
                    data = previewdata
                }
            }
            console.log(data);
            Object.keys(data).forEach(function(key){
                var thisele = document.getElementById(saveTalentIDClass[key] + "Preview" + saveTalentIDSlots[key])
                if(thisele !== undefined) thisele.innerText = data[key];
            })
        }
        function slimDownSPJSonArray(col = 'TalentID'){
            let jsonSoFar = {};
            SPJsonArray.forEach(skill => {
                jsonSoFar[skill[col]] = skill.Level;
            })
            return jsonSoFar;
        }
        function getkeyValueSetFromSPJSonArray(key = 'TalentID', value = 'Level'){
            let jsonSoFar = {};
            SPJsonArray.forEach(skill => {
                jsonSoFar[skill[key]] = skill[value];
            })
            return jsonSoFar;
        }
        function saveData(){
            document.getElementById('saveName').style.borderColor = "black";
            if(document.getElementById('saveName').value.trim() == ""){
                document.getElementById('saveName').style.borderColor = "Red";
                window.alert("Save name required :o");
                return;
            }
            if(spSpent === 0){
                window.alert("You have no skills allocated! First create or Load/Modify a build then save!");
                return;
            }
            let postObj = {
                save_name: document.getElementById('saveName').value,
                clan_code: document.getElementById('clancode').value.toLowerCase(),
                build_pass: document.getElementById('email').value.toLowerCase(),
                build_notes: document.getElementById('buildnotes').value,
                damage: document.getElementById('buildDmgType').value,
                gold: document.getElementById('buildGoldType').value,
                sp: document.getElementById('spSpent').value,
                json_blob: JSON.stringify(slimDownSPJSonArray())
            }

            $.ajax({
                url : "../TT2Builds/save",
                type : "POST",
                data : postObj,
                success : function(data) {
                    // do something
                    window.alert("Build saved with name " + document.getElementById('saveName').value);
                    console.log("Build successfully created!")
                    document.getElementById('saveName').value = "";
                    document.getElementById('clancode').value = "";
                    document.getElementById('email').value = "";
                    document.getElementById('buildnotes').value = "";
                },
                error : function(data) {
                    window.alert("Build failed to save");
                    // do something
                }
            });
        }
        function deleteBuild(){
            document.getElementById('deleteSaveName').style.borderColor = "black";
            if(document.getElementById('deleteSaveName').value.trim() == ""){
                document.getElementById('deleteSaveName').style.borderColor = "Red";
                window.alert("Delete save name required :o");
                return;
            }
            let postObj = {
                save_name: document.getElementById('deleteSaveName').value,
                build_pass: document.getElementById('deleteSavePass').value
            }

            $.ajax({
                url : "../TT2Builds/delete",
                type : "POST",
                data : postObj,
                success : function(data) {
                    // do something
                    window.alert("Build delete attempted for: " + document.getElementById('deleteSaveName').value);
                    document.getElementById('deleteSaveName').value = "";
                    document.getElementById('deleteSavePass').value = "";
                },
                error : function(data) {
                    window.alert("Build failed to delete.");
                    // do something
                }
            });
        }
        let preloadData = null
        let previewdata = null;
        function loadData(){
            let postObj = {
                id: document.getElementById('loadBuildId').value
            }

            $.ajax({
                url : "../TT2Builds/load_id",
                type : "POST",
                dataType: "json",
                data : postObj,
                success : function(data) {
                    currentPreview = data;
                    if(data == null){
                        window.alert("Didn't find build, double check the builds list.");
                        return;
                    }
                    previewdata = data.json_blob;
                    document.getElementById('loadResultView').innerHTML = "";
                    document.getElementById('loadClanResultView').innerHTML = "load results here....";
                    document.getElementById('loadResultView').innerHTML += '<button class="my-1 btn btn-success" onclick="populatePreview()">Preview</button><br>';
                    document.getElementById('loadResultView').innerHTML += "Damage: " + data.damage + "<br>";
                    document.getElementById('loadResultView').innerHTML += "Gold: " + data.gold + "<br>";
                    document.getElementById('loadResultView').innerHTML += "SP: " + data.sp + "<br>";
                    document.getElementById('loadResultView').innerHTML += "Notes: " + data.build_notes + "<br>";
                    document.getElementById('loadResultView').innerHTML += "Clan: " + data.clan_code + "<br>";
                    document.getElementById('loadResultView').innerHTML += '<button class="my-1 btn btn-success" onclick="confirmLoad()">Yes, Load this</button>';
                },
                error : function(data) {
                    window.alert("Didn't find build...");
                }
            });
        }
        function loadClanData(){
            let postObj = {
                clan_code: document.getElementById('loadClanName').value,
            }

            $.ajax({
                url : "../TT2Builds/load_clan",
                type : "POST",
                dataType : "json",
                data : postObj,
                success : function(data) {
                    console.log(data);
                    previewdata = data;
                    document.getElementById('loadResultView').innerHTML = "load results here....";
                    document.getElementById('loadClanResultView').innerHTML = "";
                    let index = 0;
                    Object.entries(data).forEach(([key, value]) => {
                        document.getElementById('loadClanResultView').innerHTML += `
                        <div class="col-3"><button class="my-1 btn w-100 btn-success" onclick="populatePreview(${index})">Preview</button></div>
                        <div class="col-6">${value.save_name} - ${value.damage}/${value.gold}/${value.sp}sp</div>
                        <div class="col-3"><button class='my-1 w-100 btn btn-success' onclick='loadClanBuild(${key})'> Load </button></div>`;
                        index++;
                    });
                    if(data === null || data === []){
                        document.getElementById('loadClanResultView').innerHTML = "<b> No Results Found! </b>";
                    }
                },
                error : function(data) {
                    window.alert("Failed to find any results...");
                }
            });
        }
        function loadClanBuild(key){
            loadSkillsFromSave(preloadData[key].json_blob,tempClanBuilds[key].sp, tempClanBuilds[key].damage, tempClanBuilds[key].gold);
            window.alert("Build loaded..");
        }
        function confirmLoad(){
            loadSkillsFromSave(preloadData.json_blob, preloadData.sp, preloadData.damage, preloadData.gold);
            window.alert("Build loaded..");
        }
        function toggleTab(button){
            var items = document.getElementsByClassName("sheetNavigationButton");
            Array.prototype.forEach.call(items, function(el) {
                el.classList.remove('active');
            });
            button.classList.add("active");
            var sheets = document.getElementsByClassName("sheet");
            Array.prototype.forEach.call(sheets, function(el) {
                el.classList.remove('active');
                el.style.display = "none";
            });
            switch(button.id){
                case "sp":
                    spOptimizer.style.display = "block";
                    break;
                case "artifact":
                    artifactOptimizer.style.display = "block";
                    break;
                default: spOptimizer.style.display = "block";
            }
            button.classList.add("active");
        }
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker
            .register('./sw.js')
            .then((reg) => { console.log('Service Worker Registered', reg); })
            .catch((error) => { console.log('Service Worker Failed.', error)})
        }

        var SPJsonArray = [];
        
        var SPreductions = {};
        var Goldreductions = {};
        
        var SelectedBuildDamage = BuildDamageOptions.Ship;
        var SelectedGoldOption = BuildGoldOptions.phom;
        var heroSkills = {};
        var playerProfileStats = {};
        var playerSkills = {};
        var playerArtifacts = {};
        var playerPassives = {}
        var importedStats = [];
        
        var spSpent = 0;
        var startingSp = 0;
        var TI;
        var TerrifyingPact;
        var enhancedEfficiency = true;
        var levelUpButton;
        var levelDownButton;
        var rankingBoxRankTemplate;
        var rankingBoxNameTemplate;
        var rankingBoxValueTemplate;

        /**
         * First thing called, will load in all the CSV data and start processing the data for each
         * 
         **/
        $(document).ready(function() {
            $.ajax({
                type: "GET",
                url: "assets/reductions.csv",
                dataType: "text",
                success: function(data) {
                    processReductions(data);
                    $.ajax({
                    type: "GET",
                    url: "assets/goldReductions.csv",
                    dataType: "text",
                    success: function(data) {
                        processGoldReductions(data);
                        $.ajax({
                        type: "GET",
                        url: activeArtifactCsv,
                        dataType: "text",
                        success: function(data) {
                            artifactCSV = data;
                            processArtifacts(data);
                            $.ajax({
                            type: "GET",
                            url: activeSpCsv,
                            dataType: "text",
                            success: function(data) {
                                initialTreeData = data;
                                processData();
                            }
                    });
                    }
                    });
                    }
                     });
                }
            });
            
        });

        var initialTreeData = null;
        /**
         * Processes the 'initialTreeData' JSON object
         * populated each individual tree array
         **/
        function processData() { 
                    allText = initialTreeData;
                    var allTextLines = allText.split(/\r\n|\n/);
                    var headings = allTextLines[0].split(',');
                    //console.log(headings);
                    SPJsonArray = [];
                    var pv = 0;
                    for (var i = 1; i < allTextLines.length; i++ ) {
                        var tarr = {};
                        tarr["Level"] = 0;
                        var currentLine = allTextLines[i].split(',');
                        for (var j=0; j<headings.length; j++) {
                            tarr[headings[j].trim()] = currentLine[j].trim();
                        }
                        if(typeof nameConversions[tarr['Name']] !== 'undefined') {
                                tarr['Name'] = nameConversions[tarr['Name']];
                        }
                        //Convert their CSV bonus type to a item of the Types list
                        //console.log(tarr, typeConversions[tarr['BonusTypeA']]);
                        tarr['BonusTypeA'] = typeConversions[tarr['BonusTypeA']];
                        tarr['BonusTypeB'] = typeConversions[tarr['BonusTypeB']];
                        //Ignore set off by default
                        tarr['Ignore'] = false;
                        //Add this finished Skill Row to the SPJsonArray
                        SPJsonArray.push(tarr);
                        //Track this particular skill with a variable for easy reference later
                        if(tarr['Name'] == "Tactical Insight"){
                                    TI = tarr;
                        }
                        if(tarr['Name'] == "Terrifying Pact"){
                            TerrifyingPact = tarr;
                        }
                    }
                    /**
                     * populate each tree array with JSON of just the given Class
                     **/
                    populateTrees();
                    
                    //Create the drop down options for build types
                    var temp = document.createDocumentFragment();
                    for(var key of Object.keys(BuildDamageOptions)){
                        var opt = document.createElement('option');
                        opt.value = BuildDamageOptions[key];
                        opt.innerHTML = BuildDamageOptions[key];
                        temp.appendChild(opt);
                    }
                    document.getElementById('buildDmgType').appendChild(temp);
                    document.getElementById('buildDmgType').onchange = function(e){
                            ChangeDamageType();
                            refreshSkills();
                            processArtifacts(artifactCSV);
                        }

                    //Create the drop down options for gold types
                    var temp = document.createDocumentFragment();
                    for(var key of Object.keys(BuildGoldOptions)){
                        var opt = document.createElement('option');
                        opt.value = BuildGoldOptions[key];
                        opt.innerHTML = BuildGoldOptions[key];
                        temp.appendChild(opt);       
                    }
                    document.getElementById('buildGoldType').appendChild(temp);
                    document.getElementById('buildGoldType').onchange = function(e){
                            ChangeGoldType();
                            refreshSkills();
                            processArtifacts(artifactCSV);
                        }

                    updateProbabilites();
                    updateEquipments();
                    initializeQuickRenderTemplates();

                    
                    Reload();
                }

        async function importData(data){
            var text;
            if(!data){
                text = await navigator.clipboard.readText();
                importedStats = JSON.parse(text);
            } else {
                importPaste.value = "";
                importedStats = JSON.parse(data);
            }
        

            for (var entry in playerPassives) delete playerPassives[entry];
            Passives.innerHTML = "<Strong>Passives</Strong>";
            var passives = importedStats.passiveSkills;
            Object.entries(passives).forEach(([key, value]) => {
                var newItem = document.createElement('div');
                newItem.textContent = key +": "+value;
                Passives.appendChild(newItem);
                playerPassives[key] = value;
            });

            for (var entry in playerSkills) delete playerSkills[entry];
            Skills.innerHTML = "";
            var skills = importedStats.skillTree;
            Object.entries(skills).forEach(([key, value]) => {
                var newItem = document.createElement('div');
                newItem.textContent = key +": "+value;
                Skills.appendChild(newItem);
                playerSkills[key] = value;
            });
            document.getElementById('loadSkills').style.visibility = "visible";

            for (var entry in playerArtifacts) delete playerArtifacts[entry];
            var artifacts = importedStats.artifacts;
            Object.entries(artifacts).forEach(([key, value]) => {
                playerArtifacts[key] = value;
            });

            var stats = importedStats.playerStats;
            PlayerStatistics.innerHTML = "<Strong>Player Stats</Strong>";
            Object.entries(stats).forEach(([key, value]) => {
                var newItem = document.createElement('div');
                newItem.textContent = key +": "+value;
                PlayerStatistics.appendChild(newItem);
                playerProfileStats[key] = value;
            });

            document.getElementById('startingSp').value = playerProfileStats["Skill Points Owned"];
            updateStartingSp(document.getElementById('startingSp'));

            var equips = importedStats.equipmentSets;
            for (var entry in playerSets) delete playerSets[entry];
            EquipmentSets.innerHTML = "";
            updateArtifacts();
            Object.entries(equips).forEach(([key, value]) => {
                var newItem = document.createElement('div');
                newItem.textContent = value;
                EquipmentSets.appendChild(newItem);
                playerSets[value] = true;
            });

            updateProbabilites();
        }

        function updateSkillRankingList(){
            var rankingBox = SkillRankings;
            rankingBox.innerHTML = "";
            var ul = document.createDocumentFragment();
            SPJsonArray.sort(function(a,b){
                return parseFloat(b.Efficiency) - parseFloat(a.Efficiency);
            });
            var i = 0;
            SPJsonArray.forEach((element) => {
                if(element.Efficiency <= 1 || element.Ignore || element.Level == element.MaxLevel) return;
                var li = getRowTemplate(element.Class).cloneNode(true);
                i++;
                li.onclick = ()=>{
                    levelSkill(element, 1);
                };
                li.addEventListener('mousedown', function(e){ e.preventDefault(); }, false);
                var rank = rankingBoxRankTemplate.cloneNode(true);
                //rank.textContent = "#"+i;
                rank.textContent = element["Co" + element.Level]+"sp";
                var Name = rankingBoxNameTemplate.cloneNode(true);
                Name.textContent = element.Name;
                var value = rankingBoxValueTemplate.cloneNode(true);
                value.textContent = Number(element.Efficiency).toFixed(4);

                // var SPbox = rankingBoxSPTemplate.cloneNode(true);
                // SPbox.textContent = element["Co" + element.Level]+"sp";
                li.appendChild(rank);
                //li.appendChild(SPbox)
                li.appendChild(Name);
                li.appendChild(value);
                ul.appendChild(li);
            });
            SkillRankings.appendChild(ul);
        }
        function updateStartingSp(input){
            startingSp = Number(input.value);
        }

        
        function processHeroSkills(data){
            var allTextLines = data.split(/\r\n|\n/);
            var firstline = allTextLines[0].split(',');
            var headings = firstline.splice(0,firstline.length);
            for (var i = 1; i < allTextLines.length; i++ ) {
                var tarr = {};
                var currentLine = allTextLines[i].split(',');
                if(typeof heroSkills[currentLine[3]] !== "undefined"){
                    if(currentLine[4] > 1.0){
                        if(currentLine[3] == "ManaPoolCap") {
                            heroSkills[currentLine[3]] = heroSkills[currentLine[3]] + Number(currentLine[4]);
                        } else {
                        heroSkills[currentLine[3]] = heroSkills[currentLine[3]] + 1;
                        }
                    } else {
                        heroSkills[currentLine[3]] = heroSkills[currentLine[3]] + Number(currentLine[4]);
                    }
                } else {
                    if(currentLine[4] > 1.0){
                        if(currentLine[3] == "ManaPoolCap") {
                            heroSkills[currentLine[3]] = Number(currentLine[4]);
                        } else {
                            heroSkills[currentLine[3]] = 1;
                        }
                    } else {
                        heroSkills[currentLine[3]] = Number(currentLine[4]);
                    } 
                }
            }

        }
        function isSpecialEffiencySkill(skillName){
            if(SpecialEffieciencies.includes(skillName)) return true;
            return false;
        }
        var warcryHelpers = 1;
        function hasT4plusOne(Class){
            switch(Class){
                case "Knight":
                    return playerSets["Shae, the Radiant Beacon"];
                break;
                case "Pet":
                    return playerSets["Ignus, the Volcanic Phoenix"];
                break;
                case "Warlord" : return playerSets["Ironheart, the Crackling Tiger"];
                break;
                case "Rogue": return playerSets["Styxsis, the Single Touch"];
                break;
                case "Sorcerer": return playerSets["Kor, the Whispering Wave"];
                break;
                case "Alchemist": return playerSets["Rygal, the Brilliant Engineer"];
                    break;
            }
        }
        

        function findSlot(tree, slot){
            for(var i = 0; i < tree.length; i++){
                if(tree[i].Slot == slot+"") return tree[i];
            }
        }
        function populateTree(id, tree){
            tree.length = 0;
            for(var i = 0; i < SPJsonArray.length; i++){
                if(SPJsonArray[i].Class == id) tree.push(SPJsonArray[i]);
            }
        }
        function processReductions(allReductions){
            var allTextLines = allReductions.split(/\r\n|\n/);
            var headings = allTextLines[0].split(',');

            var headings = headings.splice(0,headings.length);
            for (var i = 1; i < allTextLines.length; i++ ) {
                var tarr = {};
                var currentLine = allTextLines[i].split(',');
                for (var j=0; j<headings.length; j++) {
                    if(j>=1){
                        tarr[headings[j].trim()] = eval(currentLine[j].trim());
                    }else{
                        tarr[headings[j].trim()] = currentLine[j].trim();
                    }
                }
                SPreductions[tarr.Source] = tarr;
            }
        }
        function processGoldReductions(allReductions){
            var allTextLines = allReductions.split(/\r\n|\n/);
            var headings = allTextLines[0].split(',');

            var headings = headings.splice(0,headings.length);
            for (var i = 1; i < allTextLines.length; i++ ) {
                var tarr = {};
                var currentLine = allTextLines[i].split(',');
                for (var j=0; j<headings.length; j++) {
                    if(j>=1){
                        tarr[headings[j].trim()] = eval(currentLine[j].trim());
                    }else{
                        tarr[headings[j].trim()] = currentLine[j].trim();
                    }
                }
                Goldreductions[tarr.Types] = tarr;
            }
        }

        function ChangeDamageType(){
            SelectedBuildDamage = buildDmgType.value;
        }
        function ChangeGoldType(){
            SelectedGoldOption = buildGoldType.value;
        }
        function Reload(){
            $('#buildDmgType').val(SelectedBuildDamage);
            $('#buildGoldType').val(SelectedGoldOption);
            
            createTrees();

            updateTotalSpSpent();
            updateSkillRankingList();
        }
        function refreshSkills(){
            SPJsonArray.forEach((element)=>{
                levelSkill(element, 0);
            });
            Reload(); //added
        }

        function resetTree(){
            SPJsonArray.forEach(element => {
                element.Level = 0;
            })
            Reload();
        }

        function loadSkillsFrom(thisList, sp = 0, build='Ship', gold='Boss'){
            var data = thisList;
            document.getElementById('startingSp').value = sp;
            updateStartingSp(document.getElementById('startingSp'));
            document.getElementById('buildDmgType').value = build;
            document.getElementById('buildDmgType').dispatchEvent(new Event('change'))
            document.getElementById('buildGoldType').value = gold;
            document.getElementById('buildGoldType').dispatchEvent(new Event('change'))

            for(let i = 0; i < SPJsonArray.length; i++){
                SPJsonArray[i].Level = 0;
                if(data[SPJsonArray[i].Name] !== undefined){
                    levelSkill(SPJsonArray[i], data[SPJsonArray[i].Name], true);
                } else {
                    levelSkill(SPJsonArray[i], 0, true);
                }
            }
        }
        function loadSkillsFromSave(thisList, sp = 0, build='Ship', gold='Boss'){
            var data = JSON.parse(thisList);
            document.getElementById('startingSp').value = sp;
            updateStartingSp(document.getElementById('startingSp'));
            document.getElementById('buildDmgType').value = build;
            document.getElementById('buildDmgType').dispatchEvent(new Event('change'))
            document.getElementById('buildGoldType').value = gold;
            document.getElementById('buildGoldType').dispatchEvent(new Event('change'))

            for(let i = 0; i < SPJsonArray.length; i++){
                SPJsonArray[i].Level = 0;
                if(data[SPJsonArray[i].TalentID] !== undefined){
                    levelSkill(SPJsonArray[i], data[SPJsonArray[i].TalentID], true);
                } else {
                    levelSkill(SPJsonArray[i], 0, true);
                }
            }
        }

        function updateProbabilites(){
            var probsContainer = Probabilities;
            probsContainer.innerHTML = "";
            function getNewProb(labelText, inputText, valToUpdate, max){
                var newProb = document.createElement('div');
                newProb.classList = "row no-gutters";
                var newLabel = document.createElement('div');
                newLabel.classList = "col-md-12 col-lg-auto alignLabelVert";
                var label = document.createElement('label');
                label.textContent = labelText;
                newLabel.appendChild(label);
                newProb.appendChild(newLabel);
                var newInput = document.createElement('div');
                newInput.classList = "col";
                var input = document.createElement('input');
                input.value = inputText;
                input.type = "number";
                input.max = "100";
                if(max != null) input.max = max;
                input.min = "0";
                input.id = valToUpdate + "InputBox";
                input.onchange = function(){
                    playerProbabilities[valToUpdate] = Number(input.value);
                    refreshSkills();
                }
                newInput.appendChild(input);
                newProb.appendChild(newInput);
                return newProb;
            }
            var goldrat = playerProfileStats['Max Prestige Stage'] ?? ".79";
            if(playerProfileStats['Max Prestige Stage']){
                if(Number(playerProfileStats['Max Prestige Stage']) < 10000){
                    goldrat = 1.2;
                } else if(Number(playerProfileStats['Max Prestige Stage']) < 20000){
                    goldrat = 1.1;
                } else if(Number(playerProfileStats['Max Prestige Stage']) < 50000){
                    goldrat = 1.0;
                } else if(Number(playerProfileStats['Max Prestige Stage']) < 80000){
                    goldrat = .85;
                } else if(Number(playerProfileStats['Max Prestige Stage']) < 100000){
                    goldrat = .79;
                } else if(Number(playerProfileStats['Max Prestige Stage']) < 120000){
                    goldrat = .75;
                } else if(Number(playerProfileStats['Max Prestige Stage']) < 140000){
                    goldrat = .70;
                } else if(Number(playerProfileStats['Max Prestige Stage']) < 170000){
                    goldrat = .65;
                } else if(Number(playerProfileStats['Max Prestige Stage']) < 180000){
                    goldrat = .63;
                } 
            }
            
            probsContainer.appendChild(getNewProb("Gold Efficiency:", goldrat.toString(), "goldEff", 1));
            probsContainer.appendChild(getNewProb("Time Spent:", "30", "timeSpentOnBoss", 200));
            probsContainer.appendChild(getNewProb("LS %:", "2.0", "lightningStrikePercent"));
            probsContainer.appendChild(getNewProb("LS Attempts/s:", "200.0", "lightningStrikeAttempts", 500));
            probsContainer.appendChild(getNewProb("Crit%:", "100", "crit"));
            probsContainer.appendChild(getNewProb("Deadly%:", "100", "deadly"));
            probsContainer.appendChild(getNewProb("Spawn%:", "100", "multispawn"));
            // Object.entries(playerProbabilities).forEach(([key, value]) => {
            //     var newItem = document.createElement('div');
            //     newItem.textContent = key +": "+ value;
            //     probsContainer.appendChild(newItem);
            // });         
        };
        function updateEquipments(){
            function getNewEquip(labelText, valToUpdate){
                var newProb = document.createElement('div');
                newProb.classList = "row no-gutters";
                var newLabel = document.createElement('div');
                newLabel.classList = "col-12 alignLabelVert";
                var label = document.createElement('label');
                label.textContent = labelText;
                label.style.width = "100%";
                newLabel.appendChild(label);
                newProb.appendChild(newLabel);
                var newInput = document.createElement('div');
                newInput.classList = "col";
                var input = document.createElement('select');
                var option1 = document.createElement('option');
                option1.value = true;
                option1.textContent = "Obtained";
                var option2 = document.createElement('option');
                option2.value = false;
                option2.textContent = "Not Owned";
                input.style.marginBottom = "2px";
                input.appendChild(option1);
                input.appendChild(option2);
                input.onchange = function(){
                    function checkBool(string){
                        switch(string) {case "false": case "no": case "0": case "": return false; default: return true;};
                    }
                    var boole = checkBool(this.value.toLowerCase());
                    playerSets[valToUpdate] = boole;
                }
                newInput.appendChild(input);
                newProb.appendChild(newInput);
                return newProb;
            }
            var probsContainer = EquipmentSets;
            Object.entries(playerSets).forEach(([key, value]) => {
                probsContainer.appendChild(getNewEquip(key, key));
            });         
        };
        function updateArtifacts(){
            function getNewArtifact(labelText){
                var newProb = document.createElement('div');
                newProb.classList = "row no-gutters";
                var newLabel = document.createElement('div');
                newLabel.classList = "col-12 alignLabelVert";

                var label = document.createElement('label');
                label.textContent = labelText;
                label.style.width = "100%";
                newLabel.appendChild(label);
                newProb.appendChild(newLabel);
                var newInput = document.createElement('div');
                newInput.classList = "col";
                var input = document.createElement('select');
                var option1 = document.createElement('option');
                option1.value = true;
                option1.textContent = "Obtained";
                var option2 = document.createElement('option');
                option2.value = false;
                option2.textContent = "Not Owned";
                input.style.marginBottom = "2px";
                input.appendChild(option1);
                input.appendChild(option2);
                input.onchange = function(){
                    function checkBool(string){
                        switch(string) {case "false": case "no": case "0": case "": return false; default: return true;};
                    }
                    var boole = checkBool(this.value.toLowerCase());
                    playerSets[labelText] = boole;
                }
                newInput.appendChild(input);
                newProb.appendChild(newInput);
                return newProb;
            }
            var probsContainer = EquipmentSets;
            probsContainer.innerHTML = "";
            if(typeof playerArtifacts["The Master's Sword"] !== undefined){
                probsContainer.appendChild(getNewArtifact("The Master's Sword"));
            }      
        };
    </script>
       <!-- Optional JavaScript -->
       
       <script src="scripties/artifactOptimizerScript.js"></script>
       <script src="scripties/generalScripts.js"></script>
       <script src="scripties/bignumber.js"></script>
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  
</html>